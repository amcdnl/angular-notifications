!function(a){"use strict";"function"==typeof define&&define.amd?define(["angular"],a):a("object"==typeof exports?require("angular"):angular)}(function(a){var b=a.module("notifications",[]);return b.provider("$notification",function(){function b(a,c){function d(a,c,d,f,g){if("webkit"==e.html5Mode)if(0===window.webkitNotifications.checkPermission()){a||(a="favicon.ico");var h=window.webkitNotifications.createNotification(a,c,d);"function"==typeof f&&(h.ondisplay=f),"function"==typeof g&&(h.onclose=g),h.show()}else e.html5Mode=!1;else if("moz"==e.html5Mode){a||(a="favicon.ico");try{b=window.Notification||window.mozNotification;var h=new b(c,{body:d,dir:"auto",lang:"",tag:"test",icon:a})}catch(i){e.html5Mode=!1}}}var e=c,f=JSON.parse(localStorage.getItem("$notifications"))||[],g=[];return{disableHtml5Mode:function(){e.html5Mode=!1},disableType:function(a){e[a].enabled=!1},enableHtml5Mode:function(){e.html5Mode=this.requestHtml5ModePermissions()},enableType:function(a){e[a].enabled=!0},getSettings:function(){return e},toggleType:function(a){e[a].enabled=!e[a].enabled},toggleHtml5Mode:function(){e.html5Mode=!e.html5Mode},requestHtml5ModePermissions:function(){return window.webkitNotifications?0===window.webkitNotifications.checkPermission()?!0:(window.webkitNotifications.requestPermission(function(){0===window.webkitNotifications.checkPermission()?e.html5Mode="webkit":e.html5Mode=!1}),!1):window.Notification||window.mozNotification?(b=window.Notification||window.mozNotification,void b.requestPermission(function(a){"granted"==a?e.html5Mode="moz":e.html5Mode=!1})):!1},getAll:function(){return f},getQueue:function(){return g},info:function(a,b,c,d){return this.notify("info","info",a,b,c,d)},error:function(a,b,c,d){return this.notify("error","error",a,b,c,d)},success:function(a,b,c,d){return this.notify("success","success",a,b,c,d)},warning:function(a,b,c,d){return this.notify("warning","warning",a,b,c,d)},notify:function(a,b,c,d,e,f){return this.makeNotification(a,!1,b,c,d,e,f)},makeNotification:function(b,c,h,i,j,k,l){var m={type:b,image:c,icon:h,title:i,content:j,timestamp:+new Date,userData:k,duration:l,"class":e[b]["class"]};return f.push(m),void 0===l&&(l=e[b].duration),e.html5Mode?d(c,i,j,function(){},function(){}):(g.push(m),l&&a(function(){g.splice(g.indexOf(m),1)},l)),this.save(),m},save:function(){e.localStorage&&localStorage.setItem("$notifications",JSON.stringify(f))},restore:function(){},clear:function(){a(function(){g.splice(0,g.length)}),f=[],this.save()}}}var c={info:{duration:5e3,enabled:!0,"class":"info"},warning:{duration:5e3,enabled:!0,"class":"warning"},error:{duration:5e3,enabled:!0,"class":"danger"},success:{duration:5e3,enabled:!0,"class":"success"},progress:{duration:0,enabled:!0,"class":""},custom:{duration:35e3,enabled:!0,"class":""},details:!0,localStorage:!1,html5Mode:!1,templateName:"ng-notification-template"};this.setSettings=function(b){a.extend(c,b)},this.$get=["$timeout","$templateCache",function(a,d){return d.get("ng-notification-template")||d.put("ng-notification-template",'<div class="ng-notification-wrapper" ng-repeat="noti in queue"><div class="ng-notification alert alert-{{noti.class}}"><div class="ng-notification-content"><button type="button" class="close" data-dismiss="modal" ng-click="removeNotification(noti)"><span aria-hidden="true">Ã—</span><span class="sr-only">Close</span></button><span class="title" ng-bind="noti.title"></span></div></div></div>'),new b(a,c)}]}),b.directive("notifications",["$notification","$compile","$templateCache",function(a,b,c){function d(a,b,c){var d=c.notifications;d=d.split(" "),b.addClass("ng-notification-container");for(var e=0;e<d.length;e++)b.addClass(d[e])}return{restrict:"A",scope:{},template:c.get(a.getSettings().templateName),link:d,controller:["$scope",function(b){b.queue=a.getQueue(),b.removeNotification=function(a){b.queue.splice(b.queue.indexOf(a),1)}}]}}]),b});